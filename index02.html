<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8' />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <style type='text/css'>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Helvetica, Arial, Sans-Serif
        }
    </style>
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS"
        crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="slick/slick.css" />
    <link rel="stylesheet" type="text/css" href="slick/slick-theme.css" />
</head>

<body style="overflow: auto;">
    <!-- jumbotron -->
    <div class="jumbotron jumbotron-fluid">
        <div class="container">
            <h1 class="display-4">Cruffly</h1>
            <p class="lead">Your number one pet adoption service for all your adoption needs. Established since 1800
                and have
                provided homes for over 1 million pups.</p>
        </div>
    </div>
    <!-- break beinging of Nav Bar-->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">About Us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Adopt</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Volunteer</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="input-group mb-3">
        <input type="text" class="form-control" placeholder="Search zipcode" aria-label="Search zipcode"
            aria-describedby="button-addon2">
        <div class="input-group-append">
            <button class="btn btn-outline-secondary" type="button" id="button-addon2">Search</button>
        </div>
    </div>

    <!-- start of carousel -->

    <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="..." class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="..." class="d-block w-100" alt="...">
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>


    <div id='myMap' style='width: 700px; height: 500px; margin: auto;'>
        <script type='text/javascript'>


            // This function loads the map. 
            function loadMapScenario() {

                // User input is stored as empty array
                userInput = []

                // zipcode variable is added to ajax url
                zipcode = "85202"
                $.ajax({
                    url: "https://dev.virtualearth.net/REST/v1/LocalSearch/?query=animalshelter&userLocation=%2033.4255,%20-111.9400&key=As-D2zgNd8Hd4X6WJXuu8iW0NwsJ8lPQzLWR2x_YtdZuCDO3Ihg8NNgnfjTTOKf9",

                    method: "GET"

                }).then(function (res) {

                    // latitude & longitude of zipcode/ajax response is convereted to a location on map & pushpin is created to that spot
                    var lati = res.resourceSets[0].resources[0].bbox[0]
                    var long = res.resourceSets[0].resources[0].bbox[1]
                    var useInput = { latitude: lati, longitude: long, altitude: 0, altitudeReference: -1 }

                    userInput.push(useInput)
                    console.log(userInput)
                    console.log(zipcode)

                    makePushPin(userInput)



                });

                var makePushPin = function (parm) {

                    var map = new Microsoft.Maps.Map(document.getElementById('myMap'), {});
                    var location = new Microsoft.Maps.Location(parm[0].latitude, parm[0].longitude);
                    var pin = new Microsoft.Maps.Pushpin(location, (null));

                    map.entities.push(pin);
                    console.log(parm)

                }



            }

      //==================UNSUED CODE that might be helpful


           //Create an infobox at the center of the map but don't show it.
        // infobox = new Microsoft.Maps.Infobox(map.getCenter(), {
        //   visible: true
        // });
        // //39.7555° N, 105.2211° W
        // //Assign the infobox to a map instance.
        // infobox.setMap(map);

 // var map = new Microsoft.Maps.Map(document.getElementById('myMap'), {});
                // var location = new Microsoft.Maps.Location(39.7555, -105.2211);
                // var location2 = new Microsoft.Maps.Location(39.8367, -105.0372);
                // var location3 = new Microsoft.Maps.Location(39.7047, -105.0814);

                // var pin = new Microsoft.Maps.Pushpin(location, (null));
                // var pin2 = new Microsoft.Maps.Pushpin(location2, (null));
                // var pin3 = new Microsoft.Maps.Pushpin(location3, (null));

                // map.entities.push(pin);
                // map.entities.push(pin2);
                // map.entities.push(pin3);
                // console.log("===========")
                // console.log(pin.getLocation());

                // function pushpinClicked(e) {
                //   console.log("you presed a button")
                //   //Make sure the infobox has metadata to display.
                //   if (e.target.metadata) {
                //     //Set the infobox options with the metadata of the pushpin.
                //     infobox.setOptions({
                //       location: e.target.getLocation(),
                //       title: e.target.metadata.title,
                //       description: e.target.metadata.description,
                //       visible: true
                //     });
                //   }
                // }


                //Create random locations in the map bounds.
                // var randomLocations = Microsoft.Maps.TestDataGenerator.getLocations(15, map.getBounds());
                // var randoPlaces = [{ latitude: 33.53958608299653, longitude: -111.70379137551444, altitude: 0, altitudeReference: -1 }, { latitude: 33.524875765918594, longitude: -111.67331626511007, altitude: 0, altitudeReference: -1 },
                // { latitude: 33.33765219711683, longitude: -111.64064049762653, altitude: 0, altitudeReference: -1 },
                // { latitude: 33.29074931983198, longitude: -111.56711884680718, altitude: 0, altitudeReference: -1 }]





        </script>
        <script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key=As-D2zgNd8Hd4X6WJXuu8iW0NwsJ8lPQzLWR2x_YtdZuCDO3Ihg8NNgnfjTTOKf9&callback=loadMapScenario'
            async defer>



            </script>

</body>

</html>